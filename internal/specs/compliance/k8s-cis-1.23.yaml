---
spec:
  id: "0002"
  title: cis
  description: CIS Kubernetes Benchmarks
  version: "1.23"
  relatedResources:
    - https://www.cisecurity.org/benchmark/kubernetes
  controls:
    - id: 1.2.1
      name: Ensure that the --anonymous-auth argument is set to false
      description: Disable anonymous requests to the API server
      checks:
        - id: AVD-KSV-0001
      severity: MEDIUM
    - id: 1.2.10
      name: Ensure that the admission control plugin EventRateLimit is set
      description: Limit the rate at which the API server accepts requests.
      checks:
        - id: AVD-KSV-0010
      severity: HIGH
    - id: 1.2.11
      name: Ensure that the admission control plugin AlwaysAdmit is not set
      description: Do not allow all requests
      checks:
        - id: AVD-KCV-0011
      severity: LOW
    - id: 1.2.12
      name: Ensure that the admission control plugin AlwaysPullImages is set
      description: Always pull images
      checks:
        - id: AVD-KSV-0012
      severity: MEDIUM
    - id: 1.2.13
      name: Ensure that the admission control plugin SecurityContextDeny is set if
        PodSecurityPolicy is not used
      description: The SecurityContextDeny admission controller can be used to deny
        pods which make use of some SecurityContext fields which could allow for
        privilege escalation in the cluster. This should be used where
        PodSecurityPolicy is not in place within the cluster.
      checks:
        - id: AVD-KSV-0013
      severity: MEDIUM
    - id: 1.2.14
      name: Ensure that the admission control plugin ServiceAccount is set
      description: Automate service accounts management.
      checks:
        - id: AVD-KSV-0014
      severity: LOW
    - id: 1.2.15
      name: Ensure that the admission control plugin NamespaceLifecycle is set
      description: Reject creating objects in a namespace that is undergoing termination.
      checks:
        - id: AVD-KSV-0015
      severity: LOW
    - id: 1.2.16
      name: Ensure that the admission control plugin NodeRestriction is set
      description: Limit the Node and Pod objects that a kubelet could modify.
      checks:
        - id: AVD-KSV-0016
      severity: LOW
    - id: 1.2.17
      name: Ensure that the --secure-port argument is not set to 0
      description: Do not disable the secure port
      checks:
        - id: AVD-KSV-0017
      severity: HIGH
    - id: 1.2.18
      name: Ensure that the --profiling argument is set to false
      description: Disable profiling, if not needed.
      checks:
        - id: AVD-KSV-0018
      severity: LOW
    - id: 1.2.19
      name: Ensure that the --audit-log-path argument is set
      description: Enable auditing on the Kubernetes API Server and set the desired
        audit log path.
      checks:
        - id: AVD-KSV-0019
      severity: LOW
    - id: 1.2.2
      name: Ensure that the --token-auth-file parameter is not set
      description: Do not use token based authentication.
      checks:
        - id: AVD-KSV-0002
      severity: LOW
    - id: 1.2.20
      name: Ensure that the --audit-log-maxage argument is set to 30 or as appropriate
      description: Retain the logs for at least 30 days or as appropriate.
      checks:
        - id: AVD-KSV-0020
      severity: LOW
    - id: 1.2.21
      name: Ensure that the --audit-log-maxbackup argument is set to 10 or as
        appropriate
      description: Retain 10 or an appropriate number of old log file.
      checks:
        - id: AVD-KSV-0021
      severity: LOW
    - id: 1.2.22
      name: Ensure that the --audit-log-maxsize argument is set to 100 or as
        appropriate
      description: Rotate log files on reaching 100 MB or as appropriate.
      checks:
        - id: AVD-KSV-0022
      severity: LOW
    - id: 1.2.24
      name: Ensure that the --service-account-lookup argument is set to true
      description: Validate service account before validating token.
      checks:
        - id: AVD-KSV-0024
      severity: LOW
    - id: 1.2.25
      name: Ensure that the --etcd-certfile and --etcd-keyfile arguments are set as
        appropriate
      description: etcd should be configured to make use of TLS encryption for client
        connections.
      checks:
        - id: AVD-KSV-0026
      severity: LOW
    - id: 1.2.25
      name: Ensure that the --service-account-key-file argument is set as appropriate
      description: Explicitly set a service account public key file for service
        accounts on the apiserver.
      checks:
        - id: AVD-KSV-0025
      severity: LOW
    - id: 1.2.27
      name: Ensure that the --tls-cert-file and --tls-private-key-file arguments are
        set as appropriate
      description: Setup TLS connection on the API server.
      checks:
        - id: AVD-KSV-0027
      severity: MEDIUM
    - id: 1.2.28
      name: Ensure that the --client-ca-file argument is set appropriate
      description: Setup TLS connection on the API server.
      checks:
        - id: AVD-KSV-0028
      severity: LOW
    - id: 1.2.29
      name: Ensure that the --etcd-cafile argument is set as appropriate
      description: etcd should be configured to make use of TLS encryption for client
        connections.
      checks:
        - id: AVD-KSV-0029
      severity: LOW
    - id: 1.2.3
      name: Ensure that the --DenyServiceExternalIPs is not set
      description: This admission controller rejects all net-new usage of the Service
        field externalIPs.
      checks:
        - id: AVD-KSV-0003
      severity: LOW
    - id: 1.2.30
      name: Ensure that the --encryption-provider-config argument is set as
        appropriate
      description: Encrypt etcd key-value store.
      checks:
        - id: AVD-KSV-0030
      severity: LOW
    - id: 1.2.4
      name: Ensure that the --kubelet-https argument is set to true
      description: Use https for kubelet connections.
      checks:
        - id: AVD-KSV-0004
      severity: LOW
    - id: 1.2.5
      name: Ensure that the --kubelet-client-certificate and --kubelet-client-key
        arguments are set as appropriate
      description: Enable certificate based kubelet authentication.
      checks:
        - id: AVD-KSV-0005
      severity: HIGH
    - id: 1.2.6
      name: Ensure that the --kubelet-certificate-authority argument is set as
        appropriate
      description: Verify kubelets certificate before establishing connection.
      checks:
        - id: AVD-KSV-0006
      severity: HIGH
    - id: 1.2.7
      name: Ensure that the --authorization-mode argument is not set to AlwaysAllow
      description: Do not always authorize all requests.
      checks:
        - id: AVD-KSV-0007
      severity: LOW
    - id: 1.2.8
      name: Ensure that the --authorization-mode argument includes Node
      description: Restrict kubelet nodes to reading only objects associated with them.
      checks:
        - id: AVD-KSV-0008
      severity: HIGH
    - id: 1.2.9
      name: Ensure that the --authorization-mode argument includes RBAC
      description: Turn on Role Based Access Control.
      checks:
        - id: AVD-KSV-0009
      severity: HIGH
    - id: 1.3.1
      name: Ensure that the --terminated-pod-gc-threshold argument is set as
        appropriate
      description: Activate garbage collector on pod termination, as appropriate.
      checks:
        - id: AVD-KSV-0033
      severity: MEDIUM
    - id: 1.3.3
      name: Ensure that the --use-service-account-credentials argument is set to true
      description: Use individual service account credentials for each controller.
      checks:
        - id: AVD-KSV-0035
      severity: MEDIUM
    - id: 1.3.4
      name: Ensure that the --service-account-private-key-file argument is set as
        appropriate
      description: Explicitly set a service account private key file for service
        accounts on the controller manager.
      checks:
        - id: AVD-KSV-0036
      severity: MEDIUM
    - id: 1.3.5
      name: Ensure that the --root-ca-file argument is set as appropriate
      description: Allow pods to verify the API servers serving certificate before
        establishing connections.
      checks:
        - id: AVD-KSV-0037
      severity: MEDIUM
    - id: 1.3.6
      name: Ensure that the RotateKubeletServerCertificate argument is set to true
      description: Enable kubelet server certificate rotation on controller-manager.
      checks:
        - id: AVD-KSV-0038
      severity: MEDIUM
    - id: 1.3.7
      name: Ensure that the --bind-address argument is set to 127.0.0.1
      description: Do not bind the scheduler service to non-loopback insecure addresses.
      checks:
        - id: AVD-KSV-0039
      severity: LOW
    - id: 1.4.1
      name: Ensure that the --profiling argument is set to false
      description: Disable profiling, if not needed.
      checks:
        - id: AVD-KSV-0034
      severity: MEDIUM
    - id: "2.1"
      name: Ensure that the --cert-file and --key-file arguments are set as
        appropriate
      description: Configure TLS encryption for the etcd service.
      checks:
        - id: AVD-KSV-0042
      severity: MEDIUM
    - id: "2.2"
      name: Ensure that the --client-cert-auth argument is set to true
      description: Enable client authentication on etcd service.
      checks:
        - id: AVD-KSV-0043
      severity: CRITICAL
    - id: "2.3"
      name: Ensure that the --auto-tls argument is not set to true
      description: Do not use self-signed certificates for TLS.
      checks:
        - id: AVD-KSV-0044
      severity: CRITICAL
    - id: "2.4"
      name: Ensure that the --peer-cert-file and --peer-key-file arguments are set as
        appropriate
      description: etcd should be configured to make use of TLS encryption for peer
        connections.
      checks:
        - id: AVD-KSV-0045
      severity: CRITICAL
    - id: "2.5"
      name: Ensure that the --peer-client-cert-auth argument is set to true
      description: etcd should be configured for peer authentication.
      checks:
        - id: AVD-KSV-0046
      severity: CRITICAL
    - id: "2.6"
      name: Ensure that the --peer-auto-tls argument is not set to true
      description: Do not use self-signed certificates for TLS.
      checks:
        - id: AVD-KSV-0047
      severity: HIGH
    - id: "4.0"
      name: Ensure that the --profiling argument is set to false
      description: Disable profiling, if not needed.
      checks:
        - id: AVD-KSV-0040
      severity: LOW
    - id: "4.6"
      name: Ensure that the --bind-address argument is set to 127.0.0.1
      description: Do not bind the scheduler service to non-loopback insecure addresses.
      checks:
        - id: AVD-KSV-0041
      severity: CRITICAL

